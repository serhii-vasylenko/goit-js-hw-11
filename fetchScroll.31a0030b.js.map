{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,iEAWIC,EAAc,GACdC,EAAO,EAILC,GAFaC,SAASC,KAAKC,aAEpB,CACXC,WAAYH,SAASI,cAAc,gBACnCC,iBAAkBL,SAASI,cAAc,YACzCE,YAAaN,SAASI,cAAc,kB,SAYvBG,I,OAAAA,EAAfC,EAAAb,EAAA,CAAAa,EAAAC,GAAAC,MAAA,SAAAC,EAA4BC,G,IASEC,EAApBC,EAAWC,E,yEARnBH,EAAMI,iBAENjB,EAAKM,iBAAiBY,UAAY,GAElCnB,EAAO,EAEPD,EAAce,EAAMM,OAAOC,SAASC,YAAYC,M,SAEdC,EAAYzB,G,UAAlBgB,EAA8BU,EAAAC,KAAlDV,EAAoBD,EAApBC,UAAWC,EAASF,EAATE,KACnBjB,GAAQ,EAEU,IAAdgB,GAAoBjB,EAAW,C,uBACjC4B,EAAAC,OAAOC,QACL,4E,2BAKJF,EAAAC,OAAOE,QAAQ,oBAA8BC,OAAVf,EAAU,aAG7Cf,EAAKM,iBAAiByB,mBACpB,YACAC,EAAyBhB,IAI3BiB,QAAQC,IAAIjC,SAASC,KAAKC,aAAe,iBACzC8B,QAAQC,IAAIC,OAAOC,YAAc,UAEjB,IAAI3B,EAAA4B,GAAJ,CAAmB,aAAc,CAC/CC,UAAU,EACVC,aAAa,IAEPC,U,6CAnCiBC,MAAAC,KAAAC,U,UAsCZpB,EAAYqB,G,OAAZC,EAAWJ,MAAAC,KAAAC,U,UAAXE,I,OAAAA,EAAfpC,EAAAb,EAAA,CAAAa,EAAAC,GAAAC,MAAA,SAAAC,EAA2BgC,G,IAEnBE,EASAC,EAGAC,E,wEAbW,0BACXF,EAAS,IAAIG,gBAAgB,CACjCC,IAAK,qCACLC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZC,SA/DU,GAgEVC,KAAMxD,IAGFgD,EAAM,GAAgBjB,OAVX,0BAUO,MAAgBA,OAAZgB,EAAO,OAAqChB,OAAhC0B,mBAAmBZ,IAC3DX,QAAQC,IAAIa,G,SAEWU,EAAAC,QAAMC,IAAIZ,G,cAA3BC,EAAQxB,EAAAC,K,kBACPuB,EAASY,M,4CAfQnB,MAAAC,KAAAC,U,CAkB1B,SAASX,EAAyB6B,GAChC,OAAQpD,EAAAqD,EAAD,CAAID,GACRE,KACC,SAAAC,G,IACEC,EAAYD,EAAZC,aACAC,EAAaF,EAAbE,cACAC,EAAIH,EAAJG,KACAC,EAAKJ,EAALI,MACAC,EAAKL,EAALK,MACAC,EAAQN,EAARM,SACAC,EAASP,EAATO,U,MACI,kFAGUzC,OADmBoC,EAAc,4BACHpC,OAA9BmC,EAAa,mBAAwCnC,OAAvBoC,EAAc,WAIlCpC,OAJ2CqC,EAAK,kIAOzCrC,OAHPsC,EAAM,mGAMHtC,OAHIuC,EAAM,wFAMTvC,OAHDwC,EAAS,gGAGExC,OAAVyC,EAAU,+D,IAMzCC,KAAK,G,CAGV,SAASC,IACP,IAAQC,EAAuBzE,SAC5BI,cAAc,YACdsE,kBAAkBC,wBAFbC,OAIR1C,OAAO2C,SAAS,CACdC,IAAkB,EAAbL,EACLM,SAAU,U,UAICC,I,OAAAA,EAAfxE,EAAAb,EAAA,CAAAa,EAAAC,GAAAC,MAAA,SAAAC,I,IACMsE,EACwBpE,EAApBE,EAAMD,E,yEADVmE,EAAc,E,SACgB3D,EAAYzB,G,UAAlBgB,EAA8BU,EAAAC,KAAlDT,EAAoBF,EAApBE,KAAMD,EAAcD,EAAdC,UAEdmE,EAAcnE,IAEVhB,EAAOoF,KAAKC,KAAKF,EA/HT,KA+H6B,C,uBAEvCxD,EAAAC,OAAO0D,KAAM,8D,2BAGfrF,EAAKM,iBAAiByB,mBACpB,YACAC,EAAyBhB,IAE3BjB,GAAQ,EAER0E,I,6CAjB8BhC,MAAAC,KAAAC,U,CAhHhC3C,EAAKI,WAAWkF,iBAAiB,U,SASLzE,G,OAAbL,EAAYiC,MAAAC,KAAAC,U,IAN3BR,OAAOmD,iBAAiB,UAAU,WAC5BnD,OAAOoD,YAAcpD,OAAOC,cAAgBnC,SAASC,KAAKC,c,WA4GjD8E,EAAiBxC,MAAAC,KAAAC,U,CA3G5B6C,E","sources":["src/index-scroll.js"],"sourcesContent":["import 'modern-normalize/modern-normalize.css';\nimport './css/common.css';\nimport './css/styles.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nimport { Notify } from 'notiflix';\n\n// const axios = require('axios').default;\n\nlet searchQuery = '';\nlet page = 1;\nconst limit = 40;\nconst bodyOffset = document.body.offsetHeight;\n\nconst refs = {\n  searchForm: document.querySelector('.search-form'),\n  galleryContainer: document.querySelector('.gallery'),\n  fetchButton: document.querySelector('[data-fetch]'),\n};\n\nrefs.searchForm.addEventListener('submit', onFormSubmit);\n// refs.fetchButton.addEventListener('click', onMoreButtonClick);\n\nwindow.addEventListener('scroll', function () {\n  if (window.innerHeight + window.pageYOffset === document.body.offsetHeight) {\n    onMoreButtonClick();\n  }\n});\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n  \n  refs.galleryContainer.innerHTML = '';\n  // refs.fetchButton.classList.add('button--hidden');\n  page = 1;\n\n  searchQuery = event.target.elements.searchQuery.value;\n\n  const { totalHits, hits } = await fetchImages(searchQuery);\n  page += 1;\n\n  if (totalHits === 0 || !searchQuery) {\n    Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    return;\n  }\n\n  Notify.success(`Hooray! We found ${totalHits} images.`);\n\n  // refs.fetchButton.classList.remove('button--hidden');\n  refs.galleryContainer.insertAdjacentHTML(\n    'beforeend',\n    createGalleryItemsMarkup(hits)\n  );\n\n  // document.body.offsetHeight = bodyOffset;\n  console.log(document.body.offsetHeight + \" search click\");\n  console.log(window.pageYOffset + ' wo sc');\n\n  const gallery = new SimpleLightbox('.gallery a', {\n    captions: false,\n    showCounter: false,\n  });\n  gallery.refresh();\n}\n\nasync function fetchImages(searchQuery) {\n  const BASE_URI = 'https://pixabay.com/api';\n  const params = new URLSearchParams({\n    key: '32503099-d9dd46ceec4182b992252d5d9',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: limit,\n    page: page,\n  });\n\n  const uri = `${BASE_URI}/?${params}&q=${encodeURIComponent(searchQuery)}`;\n  console.log(uri);\n\n  const response = await axios.get(uri);\n  return response.data;\n}\n\nfunction createGalleryItemsMarkup(galleryItems) {\n  return [...galleryItems]\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">      \n        <a class=\"gallery__item\" href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" data-source=\"${largeImageURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b><span>${likes}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b><span></span>${views}\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b><span>${comments}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b><span>${downloads}</span> \n          </p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function onMoreButtonClick() {\n  let counterHits = 0;\n  const { hits, totalHits } = await fetchImages(searchQuery);\n\n  counterHits = totalHits;\n\n  if (page > Math.ceil(counterHits / limit)) {\n    // refs.fetchButton.classList.add('button--hidden');\n    Notify.info(`We're sorry, but you've reached the end of search results.`);\n    return;\n  }\n  refs.galleryContainer.insertAdjacentHTML(\n    'beforeend',\n    createGalleryItemsMarkup(hits)\n  );\n  page += 1;\n\n  smoothScroll();\n}\n"],"names":["$bpxeT","parcelRequire","$8f55caac40a81a7d$var$searchQuery","$8f55caac40a81a7d$var$page","$8f55caac40a81a7d$var$refs","document","body","offsetHeight","searchForm","querySelector","galleryContainer","fetchButton","$8f55caac40a81a7d$var$_onFormSubmit","$parcel$interopDefault","$2TvXO","mark","_callee","event","ref","totalHits","hits","preventDefault","innerHTML","target","elements","searchQuery","value","$8f55caac40a81a7d$var$fetchImages","_ctx","sent","$iU1Pc","Notify","failure","success","concat","insertAdjacentHTML","$8f55caac40a81a7d$var$createGalleryItemsMarkup","console","log","window","pageYOffset","$5IjG7","captions","showCounter","refresh","apply","this","arguments","searchQuery1","$8f55caac40a81a7d$var$_fetchImages","params","uri","response","URLSearchParams","key","image_type","orientation","safesearch","per_page","page","encodeURIComponent","$dIxxU","default","get","data","galleryItems","$8nrFW","map","param","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","$8f55caac40a81a7d$var$smoothScroll","cardHeight","firstElementChild","getBoundingClientRect","height","scrollBy","top","behavior","$8f55caac40a81a7d$var$_onMoreButtonClick","counterHits","Math","ceil","info","addEventListener","innerHeight","$8f55caac40a81a7d$var$onMoreButtonClick"],"version":3,"file":"fetchScroll.31a0030b.js.map"}