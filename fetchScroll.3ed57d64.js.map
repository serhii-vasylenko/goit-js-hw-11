{"mappings":"gkBASA,IAAIA,EAAc,GACdC,EAAO,EAEQC,SAASC,KAAKC,aADjC,MAGMC,EAAO,CACXC,WAAYJ,SAASK,cAAc,gBACnCC,iBAAkBN,SAASK,cAAc,YACzCE,YAAaP,SAASK,cAAc,iBAsCtCG,eAAeC,EAAYC,GACzB,MAUMC,EAAM,4BATG,IAAIC,gBAAgB,CACjCC,IAAK,qCACLC,WAAY,QACZC,YAAa,aACbC,YAAY,EACZC,SAnDU,GAoDVC,KAAMnB,SAGgCoB,mBAAmBT,KAC3DU,QAAQC,IAAIV,GAGZ,aADuBW,EAAAC,QAAMC,IAAIb,IACjBc,I,CAGlB,SAASC,EAAyBC,GAChC,MAAO,IAAIA,GACRC,KACC,EAACC,aACCA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KACI,kFAE6BL,4BACnBD,mBAA8BC,WAAuBC,kIAI3CC,mGAGOC,wFAGJC,gGAGCC,kEAM/BC,KAAK,G,CAtFVjC,EAAKC,WAAWiC,iBAAiB,UAGjC7B,eAA4B8B,GAC1BA,EAAMC,iBAENpC,EAAKG,iBAAiBkC,UAAY,GAClCzC,EAAO,EAEPD,EAAcwC,EAAMG,OAAOC,SAASC,YAAYC,MAEhD,MAAMC,UAAEA,EAASC,KAAEA,SAAerC,EAAYX,GAG9C,GAFAC,GAAQ,EAEU,IAAd8C,IAAoB/C,EAItB,YAHAiD,EAAAC,OAAOC,QACL,4EAKJF,EAAAC,OAAOE,QAAQ,oBAAoBL,aAEnC1C,EAAKG,iBAAiB6C,mBACpB,YACAzB,EAAyBoB,IAGX,IAAIM,EAAAC,GAAJ,CAAmB,aAAc,CAC/CC,UAAU,EACVC,aAAa,IAEPC,S,IA/BVC,OAAOpB,iBAAiB,UAsHxB,WACMoB,OAAOC,YAAcD,OAAOE,cAAgB3D,SAASC,KAAKC,cApBhEM,iBACE,IAAIoD,EAAc,EAClB,MAAMd,KAAEA,EAAID,UAAEA,SAAoBpC,EAAYX,GAI9C,GAFA8D,EAAcf,EAEV9C,EAAO8D,KAAKC,KAAKF,EAnHT,IAqHV,YADAb,EAAAC,OAAOe,KAAK,8DAGd5D,EAAKG,iBAAiB6C,mBACpB,YACAzB,EAAyBoB,IAE3B/C,GAAQ,EAzBV,WACE,MAAQiE,OAAQC,GAAejE,SAC5BK,cAAc,YACd6D,kBAAkBC,wBAErBV,OAAOW,SAAS,CACdC,IAAkB,EAAbJ,EACLK,SAAU,U,CAoBZC,E,CAKEC,E","sources":["src/index-scroll.js"],"sourcesContent":["import 'modern-normalize/modern-normalize.css';\nimport './css/common.css';\nimport './css/styles.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nimport { Notify } from 'notiflix';\n\nlet searchQuery = '';\nlet page = 1;\nconst limit = 40;\nconst bodyOffset = document.body.offsetHeight;\n\nconst refs = {\n  searchForm: document.querySelector('.search-form'),\n  galleryContainer: document.querySelector('.gallery'),\n  fetchButton: document.querySelector('[data-fetch]'),\n};\n\nrefs.searchForm.addEventListener('submit', onFormSubmit);\nwindow.addEventListener('scroll', onEndPageScroll);\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n  \n  refs.galleryContainer.innerHTML = '';\n  page = 1;\n\n  searchQuery = event.target.elements.searchQuery.value;\n\n  const { totalHits, hits } = await fetchImages(searchQuery);\n  page += 1;\n\n  if (totalHits === 0 || !searchQuery) {\n    Notify.failure(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n    return;\n  }\n\n  Notify.success(`Hooray! We found ${totalHits} images.`);\n  \n  refs.galleryContainer.insertAdjacentHTML(\n    'beforeend',\n    createGalleryItemsMarkup(hits)\n  );\n\n  const gallery = new SimpleLightbox('.gallery a', {\n    captions: false,\n    showCounter: false,\n  });\n  gallery.refresh();\n}\n\nasync function fetchImages(searchQuery) {\n  const BASE_URI = 'https://pixabay.com/api';\n  const params = new URLSearchParams({\n    key: '32503099-d9dd46ceec4182b992252d5d9',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: limit,\n    page: page,\n  });\n\n  const uri = `${BASE_URI}/?${params}&q=${encodeURIComponent(searchQuery)}`;\n  console.log(uri);\n\n  const response = await axios.get(uri);\n  return response.data;\n}\n\nfunction createGalleryItemsMarkup(galleryItems) {\n  return [...galleryItems]\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <div class=\"photo-card\">      \n        <a class=\"gallery__item\" href=\"${largeImageURL}\">\n          <img src=\"${webformatURL}\" data-source=\"${largeImageURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes</b><span>${likes}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Views</b><span></span>${views}\n          </p>\n          <p class=\"info-item\">\n            <b>Comments</b><span>${comments}</span>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads</b><span>${downloads}</span> \n          </p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nasync function onMoreButtonClick() {\n  let counterHits = 0;\n  const { hits, totalHits } = await fetchImages(searchQuery);\n\n  counterHits = totalHits;\n\n  if (page > Math.ceil(counterHits / limit)) {\n    Notify.info(`We're sorry, but you've reached the end of search results.`);\n    return;\n  }\n  refs.galleryContainer.insertAdjacentHTML(\n    'beforeend',\n    createGalleryItemsMarkup(hits)\n  );\n  page += 1;\n\n  smoothScroll();\n}\n\nfunction onEndPageScroll() {\n  if (window.innerHeight + window.pageYOffset === document.body.offsetHeight) {\n    onMoreButtonClick();\n  }\n}"],"names":["$8be833dd6b8028fd$var$searchQuery","$8be833dd6b8028fd$var$page","document","body","offsetHeight","$8be833dd6b8028fd$var$refs","searchForm","querySelector","galleryContainer","fetchButton","async","$8be833dd6b8028fd$var$fetchImages","searchQuery1","uri","URLSearchParams","key","image_type","orientation","safesearch","per_page","page","encodeURIComponent","console","log","$2shzp","default","get","data","$8be833dd6b8028fd$var$createGalleryItemsMarkup","galleryItems","map","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","addEventListener","event","preventDefault","innerHTML","target","elements","searchQuery","value","totalHits","hits","$eWCmQ","Notify","failure","success","insertAdjacentHTML","$parcel$interopDefault","$fZKcF","captions","showCounter","refresh","window","innerHeight","pageYOffset","counterHits","Math","ceil","info","height","cardHeight","firstElementChild","getBoundingClientRect","scrollBy","top","behavior","$8be833dd6b8028fd$var$smoothScroll","$8be833dd6b8028fd$var$onMoreButtonClick"],"version":3,"file":"fetchScroll.3ed57d64.js.map"}